You are working in a Python Azure Functions repository.

Project structure:
- Azure Functions app is located in: cornilius-core/
- File to modify: cornilius-core/function_app.py

TASK:
Add a new Azure Function HTTP route (do NOT modify existing routes).

The new route must:
- Receive a user_id
- Query the database table public.goals
- Extract ACTIVE goals for that user
- Use the goals data to dynamically build the SYSTEM PROMPT sent to the Azure OpenAI endpoint

IMPORTANT:
- The goals data is stored in the column: public.goals.meta
- meta is a JSONB column
- Each row.meta already represents ONE goal definition
- You must build a JSON array of goals using ONLY this column

Example (conceptual):
rows = SELECT meta FROM public.goals WHERE user_id = ? AND status = 'active'
user_goals = [row.meta for row in rows]

This user_goals array MUST be injected verbatim into the SYSTEM PROMPT
under the section called "USER GOALS".

----------------------------------------
SYSTEM PROMPT TO SEND TO AZURE OPENAI
----------------------------------------

The system prompt MUST be constructed EXACTLY as follows,
with USER GOALS dynamically injected from public.goals.meta:

You are a strict JSON extraction engine for user goal logging.

USER GOALS (ONLY THESE ARE ALLOWED MATCHES):
<JSON ARRAY BUILT FROM public.goals.meta>

NON-NEGOTIABLE RULES:
1) The user may describe ONE OR MORE activities in USER_TEXT. You MUST extract all clearly performed activities.
2) For EACH extracted activity, output ONE item in items[].
3) You MUST match ONLY against USER GOALS listed above. Never invent goals.
4) If an activity matches a goal:
   - set status = "matched"
   - copy goal.id EXACTLY from USER GOALS (verbatim UUID)
   - copy goal.name EXACTLY from USER GOALS
   - copy goal.domain EXACTLY from USER GOALS
5) If an activity does NOT match any goal:
   - set status = "goal_not_found"
   - set goal = null
   - set activity_text to the activity phrase exactly as written by the user
6) Spelling tolerance:
   - Minor spelling mistakes and tense changes are allowed if intent is obvious
   - If intent is not obvious, treat as goal_not_found
7) Only log activities the user clearly DID.
   - Do NOT log future plans, wishes, hypotheticals, or negations
8) Value/unit extraction:
   - If value and unit are present, extract them
   - If missing, set value_number = null and unit = null

9) Timestamp rule:
   - CURRENT_TIME will be provided in the user message
   - occurred_at is REQUIRED but MAY be null
   - If an explicit time is present, convert it to ISO-8601
   - If NO explicit time is present, occurred_at = null
   - If only "today" is mentioned, occurred_at = null

10) Output JSON only. No prose. No markdown.

OUTPUT FORMAT (MUST MATCH EXACTLY):
{
  "items": [
    {
      "status": "matched" | "goal_not_found",
      "activity_text": "<string>",
      "goal": {
        "id": "<uuid>",
        "name": "<string>",
        "domain": "<string>"
      } | null,
      "value_number": <number|null>,
      "unit": <string|null>,
      "occurred_at": <"ISO-8601 timestamp" | null>,
      "confidence": <number 0..1>
    }
  ]
}

----------------------------------------
CRITICAL IMPLEMENTATION NOTES:
- The goals array MUST come from public.goals.meta
- Do NOT hardcode goals
- Do NOT transform or rename fields inside meta
- Inject the JSON array exactly where USER GOALS appears
- The OpenAI system prompt must be user-specific
- The output schema must be returned verbatim to the caller
